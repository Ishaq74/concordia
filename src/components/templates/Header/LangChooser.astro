---
import Dropdown from "@components/ui/Dropdown.astro";
import { getRelativeLocaleUrl } from "astro:i18n";

interface Props {
  variant?: "initial" | "retro" | "modern" | "futuristic";
  class?: string;
  lang?: string;
  isMenu?: boolean;
}

const {
  variant = "initial",
  class: className = "",
  lang,
  isMenu = false,
} = Astro.props;

// Detect current locale from URL
const currentLocale = lang || Astro.currentLocale || "fr";

// Get current path without locale prefix
const pathWithoutLocale = Astro.url.pathname.replace(
  /^\/(fr|en|ar|es)(\/|$)/,
  "/",
);

const languages = [
  {
    label: "FranÃ§ais",
    icon: "ðŸ‡«ðŸ‡·",
    href: getRelativeLocaleUrl("fr", pathWithoutLocale),
    value: "fr",
  },
  {
    label: "English",
    icon: "ðŸ‡¬ðŸ‡§",
    href: getRelativeLocaleUrl("en", pathWithoutLocale),
    value: "en",
  },
  {
    label: "Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
    icon: "ðŸ‡¸ðŸ‡¦",
    href: getRelativeLocaleUrl("ar", pathWithoutLocale),
    value: "ar",
  },
  {
    label: "EspaÃ±ol",
    icon: "ðŸ‡ªðŸ‡¸",
    href: getRelativeLocaleUrl("es", pathWithoutLocale),
    value: "es",
  },
];

// Determine current language display
const currentLang =
  languages.find((lang) => lang.value === currentLocale) || languages[0];
---

<Dropdown
  items={languages}
  variant={variant}
  position="bottom-right"
  triggerLabel={currentLang.icon}
  ismenu={isMenu}
  class={className}
/>
