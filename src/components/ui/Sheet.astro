---
/**
 * Sheet (Side Panel) Component
 * Implements a pure CSS drawer using common checkbox hack or <details>
 * To adhere to "No JS", we'll use the <details> hack or standard <input type="checkbox"> for toggle.
 *
 * Props:
 * - trigger: text or icon for the button
 * - side: 'left' | 'right' (default 'right')
 */

interface Props {
    id?: string;
    side?: "left" | "right";
    class?: string;
}

const {
    id = `sheet-${Math.random().toString(36).substring(2, 9)}`,
    side = "right",
    class: className,
} = Astro.props;
---

<div class={`sheet-wrapper ${className ?? ""}`}>
    <input type="checkbox" id={id} class="sheet-toggle" />

    <label for={id} class="sheet-trigger-btn">
        <slot name="trigger">
            <span class="hamburger-icon">☰</span>
        </slot>
    </label>

    <label for={id} class="sheet-backdrop"></label>

    <div class={`sheet-content side-${side}`}>
        <div class="sheet-header">
            <label for={id} class="sheet-close">✕</label>
            <slot name="header" />
        </div>
        <div class="sheet-body">
            <slot />
        </div>
        <div class="sheet-footer">
            <slot name="footer" />
        </div>
    </div>
</div>

<style>
    .sheet-wrapper {
        display: inline-block;
    }

    .sheet-toggle {
        display: none;
    }

    .sheet-trigger-btn {
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
    }

    .sheet-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 99;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s;
        backdrop-filter: blur(2px);
    }

    .sheet-content {
        position: fixed;
        top: 0;
        bottom: 0;
        width: 300px; /* max-w-xs */
        max-width: 85vw;
        background: var(--color-surface, #ffffff);
        z-index: 100;
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        display: flex;
        flex-direction: column;
        box-shadow: -4px 0 15px rgba(0, 0, 0, 0.1);
    }

    .side-right {
        right: 0;
        transform: translateX(100%);
    }

    .side-left {
        left: 0;
        transform: translateX(-100%);
    }

    /* State: Checked (Open) */
    .sheet-toggle:checked ~ .sheet-backdrop {
        opacity: 1;
        visibility: visible;
    }

    .sheet-toggle:checked ~ .sheet-content {
        transform: translateX(0);
    }

    /* Layout */
    .sheet-header {
        padding: 1rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid var(--color-border, #e2e8f0);
    }

    .sheet-close {
        cursor: pointer;
        padding: 0.5rem;
        font-size: 1.25rem;
        line-height: 1;
    }

    .sheet-body {
        padding: 1rem;
        flex: 1;
        overflow-y: auto;
    }

    .sheet-footer {
        padding: 1rem;
        border-top: 1px solid var(--color-border, #e2e8f0);
    }

    /* Dark Mode */
    :global([data-theme="dark"]) .sheet-content {
        background: var(--color-surface, #1e293b);
        border-left: 1px solid var(--color-border, #334155);
    }
</style>
