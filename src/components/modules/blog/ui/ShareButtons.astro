---
import Button from "@components/ui/Button.astro";

interface Props {
  title: string;
  url?: string; // Optionnel, sinon prend l'URL courante
  variant?: 'initial' | 'retro' | 'modern' | 'futuristic';
}

const { title, variant = 'initial' } = Astro.props;
const url = Astro.props.url || Astro.url.href;

// Encodage pour les URLS
const encodedUrl = encodeURIComponent(url);
const encodedTitle = encodeURIComponent(title);

const shareLinks = [
  {
    name: "X (Twitter)",
    href: `https://twitter.com/intent/tweet?text=${encodedTitle}&url=${encodedUrl}`,
    icon: `<path d="M4 4l11.733 16h4.67l-16-22h-4l-11.733 16h-4.67l16 22h4z" /><path d="M4 20l6.768-6.768m2.46-2.46l6.772-6.772" />` // Path simplifi√© X/Twitter
  },
  {
    name: "LinkedIn",
    href: `https://www.linkedin.com/shareArticle?mini=true&url=${encodedUrl}&title=${encodedTitle}`,
    icon: `<path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" /><rect x="2" y="9" width="4" height="12" /><circle cx="4" cy="4" r="2" />`
  },
  {
    name: "Facebook",
    href: `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`,
    icon: `<path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z" />`
  },
  {
    name: "Email",
    href: `mailto:?subject=${encodedTitle}&body=Regarde cet article : ${encodedUrl}`,
    icon: `<rect width="20" height="16" x="2" y="4" rx="2" /><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" />`
  }
];
---

<div class={`share-container ${variant}`}>
  <span class="share-label">Partager :</span>
  {shareLinks.map(link => (
    <Button variant={variant} color="primary" size="icon" asChild> 
      <a href={link.href} target="_blank" rel="noopener noreferrer" aria-label={`Partager sur ${link.name}`}>
        <svg 
          xmlns="http://www.w3.org/2000/svg" 
          width="18" 
          height="18" 
          viewBox="0 0 24 24" 
          fill="none" 
          stroke="currentColor" 
          stroke-width="2" 
          stroke-linecap="round" 
          stroke-linejoin="round"
          set:html={link.icon} 
        />
      </a>
    </Button>
  ))}
</div>

<style>
  .share-container {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
    align-items: center;
  }

  .share-label {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-semibold);
    margin-right: var(--space-2);
    color: var(--text-muted-foreground);
  }

.share-container a:hover { color: var(--color-primary); }
</style>