---
import DocLayout from "@layouts/DocLayout.astro";
import { Code } from "astro:components";
import TableOfContents from "@/components/templates/docs/TableOfContents.astro";
import Alert from "@components/ui/Alert.astro";
import Table from "@components/ui/Table/Table.astro";
import TableHead from "@components/ui/Table/TableHead.astro";
import TableBody from "@components/ui/Table/TableBody.astro";
import TableRow from "@components/ui/Table/TableRow.astro";
import TableHeader from "@components/ui/Table/TableHeader.astro";
import TableCell from "@components/ui/Table/TableCell.astro";
import DropdownComponent from "@components/ui/Dropdown.astro";

const menuItems = [
  { label: "Profile", value: "profile", icon: "ğŸ‘¤" },
  { label: "Settings", value: "settings", icon: "âš™ï¸" },
  { label: "Messages", value: "messages", icon: "ğŸ’¬" },
  { label: "Notifications", value: "notifications", icon: "ğŸ””" },
  { label: "Help", value: "help", icon: "â“" },
  { label: "Logout", value: "logout", icon: "ğŸšª" },
];

const shortMenu = menuItems.slice(0, 3);

const longMenu = [
  ...menuItems,
  { label: "Dashboard", value: "dashboard", icon: "ğŸ“Š" },
  { label: "Analytics", value: "analytics", icon: "ğŸ“ˆ" },
  { label: "Reports", value: "reports", icon: "ğŸ“„" },
  { label: "Team", value: "team", icon: "ğŸ‘¥" },
  { label: "Projects", value: "projects", icon: "ğŸ“" },
  { label: "Calendar", value: "calendar", icon: "ğŸ“…" },
  { label: "Tasks", value: "tasks", icon: "âœ“" },
  { label: "Files", value: "files", icon: "ğŸ“‚" },
];

const menuWithLinks = [
  { label: "Home", href: "#home", icon: "ğŸ " },
  { label: "About", href: "#about", icon: "â„¹ï¸" },
  { label: "Contact", href: "#contact", icon: "ğŸ“§" },
  { label: "Blog", href: "#blog", icon: "ğŸ“" },
];

const menuWithDisabled = [
  { label: "Edit", value: "edit", icon: "âœï¸" },
  { label: "Delete", value: "delete", icon: "ğŸ—‘ï¸", disabled: true },
  { label: "Share", value: "share", icon: "ğŸ”—" },
];

const recursiveMenu = [
  { label: "Dashboard", value: "dashboard", icon: "ğŸ“Š" },
  { 
    label: "Products", 
    value: "products", 
    icon: "ğŸ“¦",
    children: [
      { label: "All Products", value: "products-all", icon: "ğŸ—‚ï¸" },
      { label: "Categories", value: "categories", icon: "ğŸ“‚",
        children: [
          { label: "Electronics", value: "cat-electronics", icon: "âš¡" },
          { label: "Clothing", value: "cat-clothing", icon: "ğŸ‘•" },
          { label: "Books", value: "cat-books", icon: "ğŸ“š" },
        ]
      },
      { label: "Add Product", value: "product-add", icon: "â•" },
    ]
  },
  {
    label: "Settings",
    value: "settings",
    icon: "âš™ï¸",
    children: [
      { label: "Profile", value: "settings-profile", icon: "ğŸ‘¤" },
      { label: "Security", value: "settings-security", icon: "ğŸ”’",
        children: [
          { label: "Password", value: "change-password", icon: "ğŸ”‘" },
          { label: "2FA", value: "2fa", icon: "ğŸ›¡ï¸" },
        ]
      },
      { label: "Notifications", value: "settings-notif", icon: "ğŸ””" },
    ]
  },
  { label: "Logout", value: "logout", icon: "ğŸšª" },
];
---

<DocLayout 
  title="Dropdown Component" 
  description="Menu dÃ©roulant avec positionnement intelligent et gestion responsive (ZERO JavaScript)" 
  variant="initial"
>
  <h1 id="dropdown-component">Dropdown Component</h1>

  <p>
    Le composant <code class="inline-code">Dropdown</code> utilise le checkbox hack CSS pour crÃ©er
    des menus dÃ©roulants sans JavaScript. Gestion intelligente du positionnement et du responsive.
  </p>

  <TableOfContents
    items={[
      { label: "Installation", href: "#installation" },
      { label: "Utilisation basique", href: "#basic" },
      { label: "Menus rÃ©cursifs", href: "#recursive" },
      { label: "Positions", href: "#positions" },
      { label: "Variants", href: "#variants" },
      { label: "FonctionnalitÃ©s", href: "#features" },
      { label: "API Reference", href: "#api" },
    ]}
    title="Table des matiÃ¨res"
  />

  <h2 id="installation">Installation</h2>

  <Code
    lang="astro"
    code={`import Dropdown from '@components/ui/Dropdown.astro';`}
  />

  <h2 id="basic">Utilisation basique</h2>

  <div class="demo-section">
    <DropdownComponent 
      items={menuItems}
      triggerLabel="Menu"
      triggerIcon="â˜°"
    />
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent 
  items={menuItems}
  triggerLabel="Menu"
  triggerIcon="â˜°"
/>`}
  />

  <h2 id="recursive">Menus rÃ©cursifs (multi-niveaux)</h2>
  <p>
    Les dropdowns supportent les sous-menus imbriquÃ©s Ã  plusieurs niveaux sans JavaScript. 
    Chaque sous-menu a sa propre checkbox pour l'Ã©tat d'ouverture/fermeture.
  </p>

  <div class="demo-section">
    <DropdownComponent 
      items={recursiveMenu}
      triggerLabel="Menu Multi-niveaux"
      triggerIcon="ğŸ“"
    />
  </div>

  <Code
    lang="astro"
    code={`const recursiveMenu = [
  { label: "Dashboard", value: "dashboard", icon: "ğŸ“Š" },
  { 
    label: "Products", 
    icon: "ğŸ“¦",
    children: [
      { label: "All Products", value: "products-all", icon: "ğŸ—‚ï¸" },
      { 
        label: "Categories", 
        icon: "ğŸ“‚",
        children: [
          { label: "Electronics", value: "cat-electronics", icon: "âš¡" },
          { label: "Clothing", value: "cat-clothing", icon: "ğŸ‘•" },
          { label: "Books", value: "cat-books", icon: "ğŸ“š" },
        ]
      },
      { label: "Add Product", value: "product-add", icon: "â•" },
    ]
  },
  {
    label: "Settings",
    icon: "âš™ï¸",
    children: [
      { label: "Profile", value: "settings-profile", icon: "ğŸ‘¤" },
      { 
        label: "Security", 
        icon: "ğŸ”’",
        children: [
          { label: "Password", value: "change-password", icon: "ğŸ”‘" },
          { label: "2FA", value: "2fa", icon: "ğŸ›¡ï¸" },
        ]
      },
      { label: "Notifications", value: "settings-notif", icon: "ğŸ””" },
    ]
  },
  { label: "Logout", value: "logout", icon: "ğŸšª" },
];

<DropdownComponent items={recursiveMenu} triggerLabel="Menu Multi-niveaux" />`}
  />

  <Alert variant="initial" status="info">
    <strong>ZERO JavaScript :</strong> Chaque sous-menu utilise une checkbox cachÃ©e + label pour gÃ©rer son Ã©tat.
    Les sous-menus s'ouvrent Ã  droite (desktop) ou en empilÃ© (mobile). Support illimitÃ© de niveaux d'imbrication !
  </Alert>

  <h2 id="positions">Positions</h2>
  <p>Le dropdown peut Ãªtre positionnÃ© de 4 faÃ§ons diffÃ©rentes par rapport au trigger.</p>

  <div class="demo-section" style="display: flex; gap: 2rem; flex-wrap: wrap; justify-content: space-between;">
    <div>
      <h4>Bottom Left (dÃ©faut)</h4>
      <DropdownComponent 
        items={shortMenu}
        triggerLabel="Bottom Left"
        position="bottom-left"
      />
    </div>

    <div>
      <h4>Bottom Right</h4>
      <DropdownComponent 
        items={shortMenu}
        triggerLabel="Bottom Right"
        position="bottom-right"
      />
    </div>

    <div>
      <h4>Top Left</h4>
      <DropdownComponent 
        items={shortMenu}
        triggerLabel="Top Left"
        position="top-left"
      />
    </div>

    <div>
      <h4>Top Right</h4>
      <DropdownComponent 
        items={shortMenu}
        triggerLabel="Top Right"
        position="top-right"
      />
    </div>
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent items={items} position="bottom-left" />
<DropdownComponent items={items} position="bottom-right" />
<DropdownComponent items={items} position="top-left" />
<DropdownComponent items={items} position="top-right" />`}
  />

  <h2 id="variants">Variants</h2>

  <h3>Variant Retro</h3>
  <div class="demo-section">
    <DropdownComponent 
      items={menuItems}
      variant="retro"
      triggerLabel="RETRO MENU"
      triggerIcon="â–£"
    />
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent 
  items={menuItems}
  variant="retro"
  triggerLabel="RETRO MENU"
/>`}
  />

  <h3>Variant Modern</h3>
  <div class="demo-section">
    <DropdownComponent 
      items={menuItems}
      variant="modern"
      triggerLabel="Modern Menu"
      triggerIcon="âœ¨"
    />
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent 
  items={menuItems}
  variant="modern"
  triggerLabel="Modern Menu"
/>`}
  />

  <h3>Variant Futuristic</h3>
  <div class="demo-section">
    <DropdownComponent 
      items={menuItems}
      variant="futuristic"
      triggerLabel="FUTURISTIC"
      triggerIcon="â—ˆ"
    />
  </div>

  <Code
    lang="astro"
    code={`<DropdownComponent 
  items={menuItems}
  variant="futuristic"
  triggerLabel="FUTURISTIC"
/>`}
  />

  <h2 id="features">FonctionnalitÃ©s</h2>

  <h3>Menu avec liens</h3>
  <p>Les items peuvent avoir des attributs <code class="inline-code">href</code> pour crÃ©er des liens.</p>

  <div class="demo-section">
    <DropdownComponent 
      items={menuWithLinks}
      triggerLabel="Navigation"
      triggerIcon="ğŸ”—"
    />
  </div>

  <Code
    lang="astro"
    code={`const menuWithLinks = [
  { label: "Home", href: "#home", icon: "ğŸ " },
  { label: "About", href: "#about", icon: "â„¹ï¸" },
  { label: "Contact", href: "#contact", icon: "ğŸ“§" },
];

<DropdownComponent items={menuWithLinks} triggerLabel="Navigation" />`}
  />

  <h3>Items dÃ©sactivÃ©s</h3>

  <div class="demo-section">
    <DropdownComponent 
      items={menuWithDisabled}
      triggerLabel="Actions"
      triggerIcon="âš¡"
    />
  </div>

  <Code
    lang="astro"
    code={`const menuWithDisabled = [
  { label: "Edit", value: "edit", icon: "âœï¸" },
  { label: "Delete", value: "delete", icon: "ğŸ—‘ï¸", disabled: true },
  { label: "Share", value: "share", icon: "ğŸ”—" },
];`}
  />

  <h3>Menu long avec scroll</h3>
  <p>Les menus longs ont un scroll automatique avec une hauteur max de 400px.</p>

  <div class="demo-section">
    <DropdownComponent 
      items={longMenu}
      triggerLabel="Long Menu"
      triggerIcon="ğŸ“‹"
    />
  </div>

  <h2 id="api">API Reference</h2>

  <h3>Props</h3>

  <div class="props-table">
    <Table variant="initial">
      <TableHeader>
        <TableRow>
          <TableHead>Prop</TableHead>
          <TableHead>Type</TableHead>
          <TableHead>DÃ©faut</TableHead>
          <TableHead>Description</TableHead>
        </TableRow>
      </TableHeader>
      <TableBody>
        <TableRow>
          <TableCell><code>items</code></TableCell>
          <TableCell><code>MenuItem[]</code></TableCell>
          <TableCell>-</TableCell>
          <TableCell>Tableau d'items du menu</TableCell>
        </TableRow>
        <TableRow>
          <TableCell><code>variant</code></TableCell>
          <TableCell><code>"initial" | "retro" | "modern" | "futuristic"</code></TableCell>
          <TableCell><code>"initial"</code></TableCell>
          <TableCell>Style visuel du dropdown</TableCell>
        </TableRow>
        <TableRow>
          <TableCell><code>position</code></TableCell>
          <TableCell><code>"bottom-left" | "bottom-right" | "top-left" | "top-right"</code></TableCell>
          <TableCell><code>"bottom-left"</code></TableCell>
          <TableCell>Position du menu par rapport au trigger</TableCell>
        </TableRow>
        <TableRow>
          <TableCell><code>triggerLabel</code></TableCell>
          <TableCell><code>string</code></TableCell>
          <TableCell><code>"Menu"</code></TableCell>
          <TableCell>Texte du bouton</TableCell>
        </TableRow>
        <TableRow>
          <TableCell><code>triggerIcon</code></TableCell>
          <TableCell><code>string</code></TableCell>
          <TableCell>-</TableCell>
          <TableCell>IcÃ´ne du bouton</TableCell>
        </TableRow>
        <TableRow>
          <TableCell><code>class</code></TableCell>
          <TableCell><code>string</code></TableCell>
          <TableCell>-</TableCell>
          <TableCell>Classes CSS supplÃ©mentaires</TableCell>
        </TableRow>
      </TableBody>
    </Table>
  </div>

  <h3>MenuItem Interface</h3>

  <Code
    lang="typescript"
    code={`interface MenuItem {
  label: string;         // Texte affichÃ©
  value?: string;        // Valeur de l'item
  icon?: string;         // Emoji ou icÃ´ne
  disabled?: boolean;    // Item dÃ©sactivÃ©
  href?: string;         // Lien (devient un <a>)
  children?: MenuItem[]; // Sous-menu rÃ©cursif (multi-niveaux)
}`}
  />

  <h2>Responsive & Smart Positioning</h2>

  <p>Le dropdown gÃ¨re automatiquement :</p>

  <ul>
    <li><strong>DÃ©bordement d'Ã©cran</strong> : Sur mobile, position automatique centrÃ©e</li>
    <li><strong>Hauteur max</strong> : 400px desktop, 300px mobile avec scroll</li>
    <li><strong>Largeur adaptative</strong> : max-width sur mobile pour Ã©viter le dÃ©bordement</li>
    <li><strong>Backdrop</strong> : Click en dehors ferme le menu</li>
    <li><strong>Scrollbar custom</strong> : Style minimaliste sur les navigateurs webkit</li>
  </ul>

  <Alert variant="initial" status="info">
    <strong>Note :</strong> ZERO JavaScript ! Tout fonctionne avec une checkbox cachÃ©e et le sÃ©lecteur <code>:checked</code>.
    Le backdrop utilise une <code>&lt;label&gt;</code> invisible pour fermer au click.
  </Alert>

  <h2>Architecture CSS Pure</h2>

  <p>Structure HTML claire et logique pour un menu dropdown avec sous-menus :</p>

  <Code
    lang="html"
    code={`<!-- Menu principal -->
<div class="dropdown">
  <input type="checkbox" id="menu" class="dropdown-state" />
  <label for="menu" class="dropdown-trigger">Menu</label>
  <label for="menu" class="dropdown-backdrop"></label>
  
  <div class="dropdown-menu position-bottom-left">
    <div class="dropdown-content">
      <!-- Item simple -->
      <label for="menu" class="dropdown-item">Dashboard</label>
      
      <!-- Item avec sous-menu -->
      <div class="dropdown-submenu">
        <input type="checkbox" id="products" class="submenu-state" />
        <label for="products" class="dropdown-item has-submenu">
          Products â–¶
        </label>
        <div class="submenu-content">
          <div class="dropdown-content">
            <label for="menu" class="dropdown-item">All Products</label>
            <!-- Peut imbriquer jusqu'Ã  3 niveaux -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>`}
  />

  <Code
    lang="css"
    code={`/* Checkbox cachÃ© pour l'Ã©tat du menu principal */
.dropdown-state {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}

/* Ouvrir le menu quand checkbox cochÃ©e */
.dropdown-state:checked ~ .dropdown-menu {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

/* Backdrop transparent pour fermer au clic extÃ©rieur */
.dropdown-state:checked ~ .dropdown-backdrop {
  display: block;
}

/* Sous-menus avec leur propre checkbox */
.submenu-state:checked ~ .submenu-content {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}`}
  />
</DocLayout>